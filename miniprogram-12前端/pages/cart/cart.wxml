<topnav></topnav>

<view class="page" style="padding:20rpx;">

  <text class="page-title">购物车</text>

  <!-- 空状态 -->
  <view wx:if="{{cartItems.length === 0}}" class="empty-box">
    <text>你的购物车空空如也～</text>
  </view>

  <!-- 列表 -->
  <block wx:for="{{cartItems}}" wx:key="id">
    <view class="cart-card">
      <image class="cart-img" src="{{item.imageLocal || item.imageUrl || '/images/default-artwork.png'}}" mode="aspectFill"></image>

      <view class="cart-body">
        <text class="cart-title">{{item.title}}</text>
        <text class="cart-meta">作者：{{item.author || '未知'}}  •  年代：{{item.era || '未知'}}</text>

        <view class="qty-row">
          <button class="qty-btn" bindtap="decrease" data-id="{{item.id}}">-</button>
          <text class="qty-text">{{item.quantity}}</text>
          <button class="qty-btn" bindtap="increase" data-id="{{item.id}}">+</button>

          <button class="delete-btn" bindtap="removeItem" data-id="{{item.id}}">删除</button>
        </view>
      </view>
    </view>
  </block>

  <!-- 底部 -->
  <view class="cart-bottom" wx:if="{{cartItems.length > 0}}">
    <text class="total-text">共 {{totalQuantity}} 件</text>
    <button class="clear-btn" bindtap="clearCart">清空购物车</button>
    <button class="checkout-btn" bindtap="checkout">去结算</button>
  </view>

</view>
